{"ast":null,"code":"var _jsxFileName = \"/Users/me/Downloads/Projects/maya-ai/src/components/Chat/Chat.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport useSessionStorage from '../../utils/useSessionStorage';\nimport { calculateMathExpression, BOT_MESSAGES } from '../../utils/chatUtils';\nimport ChatHeader from '../ChatHeader/ChatHeader';\nimport ChatFooter from '../ChatFooter/ChatFooter';\nimport ChatContent from '../ChatContent/ChatContent';\nimport './Chat.css';\n\nconst useTimeoutMessages = (timeout = 500, initialValue = [], callback) => {\n  const [preMessages, setPreMessages] = useState(initialValue);\n  const messagesRef = useRef(preMessages);\n  messagesRef.current = preMessages;\n\n  const setMessages = messages => messages.map((message, i) => setTimeout(() => {\n    setPreMessages([...messagesRef.current, message]);\n    callback && callback(message);\n  }, timeout * i));\n\n  return [preMessages, setMessages];\n};\n\nconst Chat = () => {\n  const [name, setName] = useSessionStorage('name', '');\n  const [isBot, setIsBot] = useState(true);\n  const [messages, setMessages] = useTimeoutMessages(500, [], ({\n    isUserInput\n  }) => setIsBot(!!isUserInput)); // At first render, we need to check if we already have a name in the session storage and show the correct messages\n\n  useEffect(() => {\n    if (name) {\n      setMessages([...BOT_MESSAGES.NICE_TO_SEE(name), ...BOT_MESSAGES.DESCRIBE_PROCESS()]);\n    } else {\n      setMessages(BOT_MESSAGES.INTRO());\n    }\n  }, []);\n\n  const sendMessageHandler = async newMessage => {\n    // We check if this is the user turn to give an input.\n    // If we already have a name, we expect math expression. Otherwise, we expect a name and add the correct messages.\n    if (!isBot) {\n      setIsBot(true);\n\n      if (!name) {\n        setName(newMessage);\n        await setMessages([{\n          message: newMessage,\n          isUserInput: true\n        }, ...BOT_MESSAGES.NICE_TO_MEET(newMessage), ...BOT_MESSAGES.DESCRIBE_PROCESS()]);\n      } else {\n        await setMessages([{\n          message: newMessage,\n          isUserInput: true\n        }, {\n          message: calculateMathExpression(newMessage)\n        }, ...BOT_MESSAGES.BOT_FEEDBACK()]);\n      }\n\n      console.log(\"now\");\n      setIsBot(false);\n      return;\n    } // Add user messages to the list even if it is not the user turn\n\n\n    setMessages([{\n      message: newMessage,\n      isUserInput: true\n    }]);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ChatHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(ChatContent, {\n    messages: messages,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(ChatFooter, {\n    onSend: sendMessageHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default Chat;","map":{"version":3,"sources":["/Users/me/Downloads/Projects/maya-ai/src/components/Chat/Chat.js"],"names":["React","useState","useEffect","useRef","useSessionStorage","calculateMathExpression","BOT_MESSAGES","ChatHeader","ChatFooter","ChatContent","useTimeoutMessages","timeout","initialValue","callback","preMessages","setPreMessages","messagesRef","current","setMessages","messages","map","message","i","setTimeout","Chat","name","setName","isBot","setIsBot","isUserInput","NICE_TO_SEE","DESCRIBE_PROCESS","INTRO","sendMessageHandler","newMessage","NICE_TO_MEET","BOT_FEEDBACK","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport useSessionStorage from '../../utils/useSessionStorage'\nimport { calculateMathExpression, BOT_MESSAGES } from '../../utils/chatUtils';\nimport ChatHeader from '../ChatHeader/ChatHeader'\nimport ChatFooter from '../ChatFooter/ChatFooter';\nimport ChatContent from '../ChatContent/ChatContent';\n\nimport './Chat.css';\n\nconst useTimeoutMessages = (timeout = 500, initialValue = [], callback) => {\n    const [preMessages, setPreMessages] = useState(initialValue)\n    const messagesRef = useRef(preMessages)\n    messagesRef.current = preMessages\n\n    const setMessages = messages => \n        messages.map((message, i) => \n          \n        setTimeout(() => {\n           setPreMessages([...messagesRef.current, message])\n           callback && callback(message)\n          }, timeout * i)\n        )\n\n  \n    return [preMessages, setMessages]\n  }\n\n\nconst Chat = () => {\n    const [name, setName] = useSessionStorage('name', '')\n    const [isBot, setIsBot] = useState(true) \n    const [messages, setMessages] = useTimeoutMessages(500, [], ({ isUserInput })=> setIsBot(!!isUserInput))\n\n   \n    // At first render, we need to check if we already have a name in the session storage and show the correct messages\n    useEffect(()=>{\n        if (name) {\n            setMessages([...BOT_MESSAGES.NICE_TO_SEE(name), ...BOT_MESSAGES.DESCRIBE_PROCESS()]) \n        }\n        else {\n            setMessages(BOT_MESSAGES.INTRO())\n        }\n    }, [])\n\n\n    const sendMessageHandler = async (newMessage) => {\n        // We check if this is the user turn to give an input.\n        // If we already have a name, we expect math expression. Otherwise, we expect a name and add the correct messages.\n        if (!isBot) {   \n            setIsBot(true)\n            if(!name) {\n                setName(newMessage)\n                await setMessages([ \n                            { message: newMessage, isUserInput: true },\n                            ...BOT_MESSAGES.NICE_TO_MEET(newMessage), \n                            ...BOT_MESSAGES.DESCRIBE_PROCESS()])\n            } else {\n                await setMessages([ \n                            { message: newMessage, isUserInput: true },\n                            { message: calculateMathExpression(newMessage) }, \n                            ...BOT_MESSAGES.BOT_FEEDBACK()])\n            }\n            \n            console.log(\"now\")\n            setIsBot(false)\n           return\n        }\n        // Add user messages to the list even if it is not the user turn\n        setMessages([{ message: newMessage, isUserInput: true }])\n        \n    }\n\n  return (\n    <div className=\"chat-container\">\n        <ChatHeader/>\n        <ChatContent messages={messages}/>\n        <ChatFooter onSend={sendMessageHandler}/>\n    </div>\n  );\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}